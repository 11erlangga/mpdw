---
title: "Tugas Pertemuan 5"
output: 
  html_document: 
    theme: cosmo
    toc: true
    toc_float: true
---

# Proses MA(2)

## Pembangkitan Data

```{r}
set.seed(75)
wn <- rnorm(300)
ma2 <- c(wn[1], wn[2])
for(i in 3:300){
   ma2[i] <- wn[i] + 0.4 * wn[i - 1] + 0.6 * wn[i - 2]
}
ma2
```

```{r}
ma2 <- arima.sim(list(order=c(0, 0, 2), ma=c(0.4, 0.6)), 
                 n=300)
ma2
```

## Visualisasi

### Plot Time Series

```{r}
ts.plot(ma2)
```

Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan stasioner dalam rataan.

### Plot ACF

```{r}
acf(ma2,lag.max = 20)
```

Berdasarkan plot ACF tersebut, terlihat bahwa plot ACF *cuts off* di lag pertama dan kedua.

### Plot PACF

```{r}
pacf(ma2)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung *tails off* dan membentuk gelombang sinus.

### Plot EACF

```{r}
TSA::eacf(ma2)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

### Scatterplot antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ma2 <- ma2[-1]
yt_1_ma2 <- ma2[-300]

plot(y=yt_ma2, 
     x=yt_1_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ma2, yt_1_ma2)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1 = 
\frac{\theta_1 + \theta_1 \theta_2}{1 + \theta_1^2 + \theta_2^2} = 
\frac{0.4 + 0.4 \cdot 0.6}{1 + 0.4^2 + 0.6^2} = 
0.421
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ma2 <- ma2[-c(1, 2)]
yt_2_ma2 <- ma2[-c(299, 300)]

plot(y=yt_ma2, 
     x=yt_2_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ma2, yt_2_ma2)
```

$$
\rho_2 = 
\frac{-\theta_2}{1 + \theta_1^2 + \theta_2^2} = 
\frac{-0.6}{1 + 0.4^2 + 0.6^2} = 
0.395
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ma2 <- ma2[-c(1, 2, 3)]
yt_3_ma2 <- ma2[-c(288, 299, 300)]

plot(y=yt_ma2, 
     x=yt_3_ma2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ma2, yt_3_ma2)
```

# Proses AR(2)

## Pembangkitan Data

```{r}
set.seed(75)
wn <- rnorm(300)
ar2 <- 1:300
for (i in 3:300) {
  ar2[i] <- wn[i] + 0.5 * ar2[i-1] + 0.2 * ar2[i-2]
}
ar2
```

```{r}
ar2 <- arima.sim(list(order=c(2, 0, 0), ar=c(0.7, 0.2)), 
                 n=300)
ar2
```

## Visualisasi

### Plot Time Series

```{r}
ts.plot(ar2)
```

Berdasarkan plot time series, terlihat bahwa data AR(2) yang dibangkitkan stasioner dalam rataan.

### Plot ACF

```{r}
acf(ar2,lag.max = 20)
```

Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung *tails off* dan cenderung membentuk pola grafik sinus.

### Plot PACF

```{r}
pacf(ar2)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF *cuts off* pada lag pertama dan kedua, sejalan dengan teori yang ada.

### Plot EACF

```{r}
TSA::eacf(ar2)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(1)

### Scatterplot antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ar2 <- ar2[-1]
yt_1_ar2 <- ar2[-300]

plot(y=yt_ar2, 
     x=yt_1_ar2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2, yt_1_ar2)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1 = 
\frac{\phi_1}{1 - \phi_2} = 
\frac{0.7}{1 - 0.2} = 
0.875
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ar2 <- ar2[-c(1, 2)]
yt_2_ar2 <- ar2[-c(299, 300)]

plot(y=yt_ar2, 
     x=yt_2_ar2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2, yt_2_ar2)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_2 = 
\phi_1 \rho_1 + \phi_2 \rho_0 = 
0.7 \cdot 0.875 + 0.2 \cdot 1 = 
0.8125
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ar2 <- ar2[-c(1, 2, 3)]
yt_3_ar2 <- ar2[-c(288, 299, 300)]

plot(y=yt_ar2, 
     x=yt_3_ar2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ar2, yt_3_ar2)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_3 = 
\phi_1 \rho_2 + \phi_2 \rho_1 = 
0.7 \cdot 0.8125 + 0.2 \cdot 0.875 = 
0.74375
$$

# Proses ARMA(2, 2)

## Pembangkitan Data

```{r}
arma.sim <- function(n, ma.coef, ar.coef){
  ma.num <- length(ma.coef)
  ar.num <- length(ar.coef)
  stopifnot(ma.num < n & ar.num < n)
  
  wn <- rnorm(n, sd = 0.5)
  init <- max(ma.num, ar.num)

  arma <- wn[1:init]
  for(i in {init+1}:n){
   ma.start <- i - ma.num
   ma.end <- i-1
   
   ar.start <- i - ar.num
   ar.end <- i-1
   
   arma[i] <- sum(ar.coef * arma[ar.start:ar.end]) + sum(ma.coef * wn[ma.start:ma.end])  + wn[i]
   }
  return(arma)
}

arma22 <- arma.sim(300, c(0.4, 0.6), c(0.5, 0.2))
arma22
```

```{r}
arma22 <- arima.sim(list(order=c(2, 0, 2), ma=c(0.4, 0.6), ar=c(0.5, 0.2)), 
                 n=300)
arma22
```

## Visualisasi

### Plot Time Series

```{r}
ts.plot(arma22)
```

Berdasarkan plot time series, terlihat bahwa data ARMA(2, 2) yang dibangkitkan stasioner dalam rataan.

### Plot ACF

```{r}
acf(arma22, lag.max = 20)
```

Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2, 2) hasil simulasi memiliki plot ACF yang *tails off*, sesuai dengan teori yang ada.

### Plot PACF

```{r}
pacf(arma22)
```

Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2, 2) hasil simulasi memiliki plot PACF yang *tails off*, sesuai dengan teori.

### Plot EACF

```{r}
TSA::eacf(arma22)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(9)

### Scatterplot antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_arma22 <- arma22[-1]
yt_1_arma22 <- arma22[-300]

plot(y=yt_arma22, 
     x=yt_1_arma22)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma22, yt_1_arma22)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1 = 
\frac{\phi_1}{1 - \phi_2} = 
\frac{0.7}{1 - 0.2} = 
0.875
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_arma22 <- arma22[-c(1, 2)]
yt_2_arma22 <- arma22[-c(299, 300)]

plot(y=yt_arma22, 
     x=yt_2_arma22)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_arma22, yt_2_arma22)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_2 = 
\phi_1 \rho_1 + \phi_2 \rho_0 = 
0.7 \cdot 0.875 + 0.2 \cdot 1 = 
0.8125
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_arma22 <- arma22[-c(1, 2, 3)]
yt_3_arma22 <- arma22[-c(288, 299, 300)]

plot(y=yt_arma22, 
     x=yt_3_arma22)
```

Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_arma22, yt_3_arma22)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_3 = 
\phi_1 \rho_2 + \phi_2 \rho_1 = 
0.7 \cdot 0.8125 + 0.2 \cdot 0.875 = 
0.74375
$$